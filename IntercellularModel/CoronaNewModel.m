function dx = CoronaNewModel(t,x)
global ST ET m alph rm %lam
ET = 100;
dx = zeros(6,1);

rT = 0.1;
Tm = 1e+11;
de = 0.5;
lam = 1;
Mm = 4e+12;
da = 0.033;
bet = 11.4e-8; delt = 0.239; a1 = 0.9; p3 = 5.89e-3; k = 3.15e-10; c = 1.46; pm = 3.77e-5;
% median
% bet = 10.5e-8; delt = 0.248; a1 = 0.875; m = 0.073; p3 = 5.89e-3; k = 3.15e-10; c = 1.50; alph = 7.08e-9; pm = 2.52e-5; rm = 1.98;
% bet = 11.4e-8; delt = 0.239; a1 = 0.9; m = 0.057; p3 = 5.89e-3; k = 3.15e-10; c = 1.46; alph = 7.08e-9; pm = 3.77e-5; rm = 1.98/2;
% patient1
% bet = 2.07e-7; delt = 0.248; a1 = 0.9; m = 0.047; p3 = 1.56e-3*1.4; k=2.37e-10; c=1.24; alph=1.72e-8; pm=1.33e-5; rm=1.98;
% patient2
% bet = 1.69e-8*1.5; delt = 0.248; a1 = 0.9; m = 0.00578; p3 = 8.13e-3; k = 2.63e-10*1.4; c = 3.15; alph = 5.87e-10*2; pm = 8.65e-7*10; rm = 1.58+0.05;
% patient3
% bet = 1.55e-7/1.7; delt = 0.344; a1 = 0.9; m = 0.495/5; p3 = 2.12e-3; k = 2.69e-10; c = 1.18; alph = 1.03e-8*1.5; pm = 1.69e-5/1.2; rm = 2.25/1.1;
% patient4
% bet = 8.74e-7; delt = 1.84; a1 = 0.92; m = 0.0276; p3 = 4.42e-3; k = 3.24e-10; c = 1.4; alph = 6.01e-10; pm = 3.44e-6; rm = 1.32;
% bet = 15.51e-8; delt = 0.2; a1 = 1; m = 0.001/2; p3 = 9.4e-3/2; k = 2.2e-10; c = 1.61/2; alph = 1.37e-9/1.5; pm = 4.43e-5; rm = 1.25;
% patient5
% bet = 1.11e-7; delt = 0.212; a1 = 2.57; a2 = 2.29; m = 0.498; p3 = 2.43e-3; k = 2.52e-10; c = 1.61; alph = 1.05e-8; pm = 3.16e-5; rm = 1.45;
% bet = 5.89e-8; delt = 0.17; a1 = 1; m = 0.115; p3 = 1.96e-3; k = 5.55e-10; c = 1.14; alph = 1.91e-8; pm = 1.94e-5; rm = 1.37;
% patient6
% bet = 8.92e-8/1.4; delt = 0.0342; a1 = 2.38; a2 = 2.21; m = 0.00553; p3 = 3.81e-3; k = 2.63e-10; c = 1.01; alph = 1.58e-8; pm = 1.57e-5; rm = 1.34*1.03;
% bet = 1.3e-7; delt = 0.275; a1 = 0.82; m = 0.187; p3 = 3.2e-3; k = 5e-10; c = 1.89; alph = 7.89e-9; pm = 3.1e-5; rm = 1.48;
% patient7
% bet = 2.48e-7/2.5; delt = 0.222; a1 = 2.88; a2 = 2.62; m = 0.46; p3 = 0.0149; k = 2.73e-10; c = 2.08/1.1; alph = 4.3e-9*2.5; pm = 2.37e-5; rm = 3.31/1.2; %with v0 = 10000 and +1
% bet = 2.48e-7/2.5; delt = 0.222; a1 = 0.8; m = 0.3; p3 = 0.014; k = 2.73e-10; c = 1.73+0.2; alph = 4.3e-9*2.8*1.5; pm = 2.37e-5; rm = 2.76+0.3;
% bet = 13.3e-8; delt = 0.2; a1 = 0.85; m = 0.2; p3 = 9.91e-3; k = 4.28e-10; c = 1.97; alph = 4.48e-9*1.4; pm = 7.9e-5/1.2; rm = 2.83;
% patient8
% bet = 3.68e-7/3.5; delt = 0.63; a1 = 0.8; m = 0.0255; p3 = 0.0056; k = 3.28e-10; c = 0.538+0.15; alph = 4.41e-8*2.5*1.5; pm = 6.12e-5; rm = 1.89+0.3;
% bet = 9.46e-8*1.1; delt = 0.35; a1 = 0.8; m = 0.04; p3 = 8.03e-3/2.2; k = 3.5e-10; c = 1.3; alph = 9.74e-9*1.7; pm = 7e-5; rm = 2.24-0.06;
% patient9
% bet = 2.12e-7/2; delt = 0.51; a1 = 0.84; m = 0.0106/3; p3 = 0.0104; k = 2.8e-10; c = 0.991+0.1; alph = 8.58e-10; pm = 9.53e-6; rm = 1.73+0.4;
% patient10
% bet = 1.83e-7/1.5; delt = 0.229; a1 = 0.8; m = 0.496/3; p3 = 0.0418; k = 2.66e-10; c = 3.91; alph = 3e-9; pm = 5.65e-5; rm = 1.8-0.23;  
% bet = 12.2e-8; delt = 0.229; a1 = 0.8; m = 0.16/1.3; p3 = 41.8e-3/4.1; k = 2.66e-10; c = 3.91; alph = 3e-9; pm = 5.65e-5; rm = 1.57;
% patient11
% bet = 5.28e-8; delt = 3.11-2.6; a1 = 6; a2 = 6; m = 0.0523*3; p3 = 3.29e-3; k = 4.27e-10/2; c = 0.716*1.5; alph = 7.16e-9*6; pm = 2.88e-5/4; rm = 3.25-0.6;
% bet = 1.15e-7; delt = 0.326; a1 = 0.8; m = 0.2/3; p3 = 1.3e-3; k = 5.44e-10; c = 0.157; alph = 3.42e-8; pm = 7.44e-5; rm = 2.42;
% bet = 12.5e-8; delt = 0.2; a1 = 0.9; m = 0.2/3; p3 = 1.3e-3; k = 4e-10; c = 0.75; alph = 8.09e-9; pm = 6.5e-5; rm = 2.54-0.04;
% patient12
% bet = 1.34e-7; delt = 0.177*2; a1 = 0.7; m = 0.000208*50; p3 = 6.42e-3; k = 9.65e-11/1.2; c = 1.37; alph = 8.18e-10*2; pm = 1.45e-3; rm = 1.61+0.17;
% bet = 6.07e-8; delt = 0.2; a1 = 0.9; m = 0.001; p3 = 9.31e-3; k = 0.9e-10*1.4; c = 1.7; alph = 1.12e-9; pm = 7.7e-5; rm =1.98;

p1 = p3/100;

%%%% Treatment %%%%
% ST = 10; %eps = 0; eta = 1;
% ET = 20;
if (ST < t && t < ET)
    eps = 1;
    eta = 0.1;
else
    eps = 0;
    eta = 1;
end
dx(1) = rT * x(1) * (1 - ((x(1)+x(2)+x(3)) / Tm)) - bet * x(1) * x(4);
% dx(2) = bet * x(1) * x(4) - delt * x(2) - a1 * (1 - eps * heaviside(t - ST)) * x(2) - m * x(2) * x(5);
% dx(3) = a1 * (1 - eps * heaviside(t - ST)) * x(2) - delt * x(3) - m * x(3) * x(5);
% dx(4) = p1 * eps * heaviside(t - ST) * x(2) + p3 * (1 + (eta - 1) * heaviside(t - ST)) * x(3) - c * x(4) - k * x(6) * x(4);
dx(2) = bet * x(1) * x(4) - delt * x(2) - a1 * (1 - eps) * x(2) - m * x(2) * x(5);
dx(3) = a1 * (1 - eps) * x(2) - delt * x(3) - m * x(3) * x(5);
dx(4) = p1 * eps * x(2) + p3 * eta * x(3) - c * x(4) - k * x(6) * x(4);
dx(5) = lam + alph * x(2) * x(5) + alph * x(3) * x(5) - de * x(5);
dx(6) = pm * x(4) + rm * x(6) * (1 - x(6)/Mm) - k * x(6) * x(4) - da * x(6);
end